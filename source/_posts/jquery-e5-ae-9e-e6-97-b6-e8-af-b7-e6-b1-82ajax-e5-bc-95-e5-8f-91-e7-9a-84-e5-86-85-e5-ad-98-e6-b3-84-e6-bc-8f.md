---
title: jquery 实时请求ajax引发的内存泄漏
url: 504.html
id: 504
categories:
  - js/jquery/ajax
date: 2017-05-23 18:41:41
tags:
---

    工作中下载界面需要实时获取第三发接口返回的下载速度、进度等，采用ajax异步请求实时数据，有两个定时器，一个获取当前下载速度，一个获取下载任务详情，设置定时任务每隔2秒请求一次接口，由于下载的文件都上了百G，顾有可能用户长时间停留界面，如果内存泄漏的话，长时间肯定卡死！！  

    经过反复测试内存泄漏情况，发现是由于ajax请求引起的。于是找解决办法：  

第一、用的是当前最新的jquery版本，替换为稳定版本，测试后还是有所增涨，但涨幅开始放缓，有涨有放。

第二、清空XMLHttpRequest对象，jQuery唯一能做的就是使用：complete: function (XHR, TS) { XHR = null; }

两种办法实行起来后，开始测试1小时，mem从4.4%涨到5.0%～5.1%维稳，到半小时时就到达5.0%～5.1%，这个结果还是可以接受滴。

以上方法仅仅是在不渲染界面，单调接口的情况，待续。。。